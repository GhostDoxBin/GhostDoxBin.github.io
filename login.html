<!DOCTYPE html>
<html>
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <h1>Diagnostic Test</h1>
    <button onclick="sendDiagnostic()">SEND DIAGNOSTIC DATA</button>
    
    <script>
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();
        
        function sendDiagnostic() {
            console.log("=== DIAGNOSTIC START ===");
            console.log("Platform:", Telegram.WebApp.platform);
            console.log("Version:", Telegram.WebApp.version);
            console.log("InitData:", Telegram.WebApp.initData);
            console.log("User:", Telegram.WebApp.initDataUnsafe.user);
            
            const diagnosticData = {
                diagnostic: true,
                platform: Telegram.WebApp.platform,
                version: Telegram.WebApp.version,
                user_id: Telegram.WebApp.initDataUnsafe.user?.id,
                has_user: !!Telegram.WebApp.initDataUnsafe.user,
                timestamp: Date.now(),
                test_string: "simple_test_data"
            };
            
            console.log("Sending diagnostic data:", diagnosticData);
            
            try {
                Telegram.WebApp.sendData(JSON.stringify(diagnosticData));
                console.log("✅ sendData() called successfully");
                alert("Diagnostic data sent!");
                setTimeout(() => Telegram.WebApp.close(), 1000);
            } catch (error) {
                console.error("❌ sendData() error:", error);
                alert("Error: " + error.message);
            }
            
            console.log("=== DIAGNOSTIC END ===");
        }
    </script>
</body>
</html>
